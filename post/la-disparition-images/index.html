<!DOCTYPE html>
<html lang="fr" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>AngularJS, mobile et disparition d&#39;image. - Richard Fagot</title>
  <meta name="description" content="Chez certains opérateurs mobile, les images ne s&#39;affichent pas avec AngularJS.">
  <meta name="author" content="Richard Fagot"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Richard Fagot",
    
    "url": "https:\/\/richard-fagot.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/richard-fagot.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/richard-fagot.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/richard-fagot.github.io\/post\/la-disparition-images\/",
          "name": "Angular j s, mobile et disparition d\x27image."
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Richard Fagot"
  },
  "headline": "AngularJS, mobile et disparition d\x27image.",
  "description" : "Chez certains opérateurs mobile, les images ne s\x27affichent pas avec AngularJS.",
  "inLanguage" : "fr",
  "wordCount":  469 ,
  "datePublished" : "2016-03-11T00:00:00",
  "dateModified" : "2016-03-11T00:00:00",
  "image" : "https:\/\/richard-fagot.github.io\/img\/avatar.png",
  "keywords" : [ "Angular, Opérateur mobile, Images" ],
  "mainEntityOfPage" : "https:\/\/richard-fagot.github.io\/post\/la-disparition-images\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/richard-fagot.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/richard-fagot.github.io\/img\/avatar.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="AngularJS, mobile et disparition d&#39;image." />
<meta property="og:description" content="Chez certains opérateurs mobile, les images ne s&#39;affichent pas avec AngularJS.">
<meta property="og:image" content="https://richard-fagot.github.io/img/avatar.png" />
<meta property="og:url" content="https://richard-fagot.github.io/post/la-disparition-images/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Richard Fagot" />

  <meta name="twitter:title" content="AngularJS, mobile et disparition d&#39;image." />
  <meta name="twitter:description" content="Chez certains opérateurs mobile, les images ne s&#39;affichent pas avec AngularJS.">
  <meta name="twitter:image" content="https://richard-fagot.github.io/img/avatar.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@@richardfagot" />
  <meta name="twitter:creator" content="@@richardfagot" />
  <link href='https://richard-fagot.github.io/img/favicon.png' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.69.2" />
  <link rel="alternate" href="https://richard-fagot.github.io/index.xml" type="application/rss+xml" title="Richard Fagot"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://richard-fagot.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://richard-fagot.github.io/css/syntax.css" /><link rel="stylesheet" href="https://richard-fagot.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://richard-fagot.github.io/">Richard Fagot</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Richard Fagot" href="https://richard-fagot.github.io/">
            <img class="avatar-img" src="https://richard-fagot.github.io/img/avatar.png" alt="Richard Fagot" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>AngularJS, mobile et disparition d&#39;image.</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posté le 11 March 2016
  
  
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Richard Fagot
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>Une application web mobile en <strong>AngularJS</strong>, des images qui tantôt s&rsquo;affichent sur certains mobiles, tantôt pas. La disparition de ces images n&rsquo;est pas mystérieuse ni aléatoire mais est causée par des êtres se dissimulant dans les profondeurs obscures du réseau et laissant leur trace dans nos applications développées avec force et courage.</p>
<h2 id="tldr">TL,DR</h2>
<ol>
<li>Utilisez la directive <code>ng-src</code> pour indiquer l&rsquo;emplacement relatif de vos images ;</li>
<li>Fin.</li>
</ol>
<h2 id="le-contexte">Le contexte</h2>
<p>Pour un client, nous avons développé une application <strong>AngularJS</strong> avec Bootstrap pour une utilisation sur mobile en 3G/4G.</p>
<p>Lors des tests, il s&rsquo;est trouvé des cas où les images n&rsquo;apparaissaient pas et, après investigation, seuls les utilisateurs sous certains opérateurs en 3G étaient concernés.</p>
<h2 id="la-raison-du-problème">La raison du problème</h2>
<p>Certains opérateurs effectuent des manipulations des ressources téléchargées avant des les envoyer au navigateur.</p>
<p>Par exemple, il est assez courant que les images soient recompressées, donnant, au passage, <a href="http://www.hteumeuleu.fr/la-compression-dimages-par-les-operateurs/">des résultats parfois franchement dégradés</a>.</p>
<p>Parfois, les opérateurs vont plus loin et modifient le code source de la page HTML elle-même. Et, dans notre cas, ils passent sur les attributs <code>src</code> et remplacent les urls en chemin relatif par une url en chemin absolu à partir de l&rsquo;url du fichier HTML lu.</p>
<p>Dans le cas d&rsquo;<strong>AngularJS</strong>, les différentes vues de l&rsquo;application sont distribuées dans des fichiers HTML possédant une arborescence propre et éloignée de la racine ou se trouve le <em>index.html</em>.</p>
<p><strong>AngularJS</strong> gère très bien ces urls relatives à la racine de l&rsquo;application même si elles sont écrite dans une sous-arborescence. C&rsquo;est précisément ce qu&rsquo;on lui demande.</p>
<p>Le problème est que l&rsquo;opérateur remplace la valeur des attributs <code>src</code> en chemin relatif avant le passage d&rsquo;<strong>AngularJS</strong> par des url en chemin absolu en partant de l&rsquo;emplacement du fichier HTML qui les contient.</p>
<p>On se retrouve donc avec des :</p>
<p><code>http://context/app/component/vue/app/assets/images/mon_image.png</code></p>
<p>au lieu de :</p>
<p><code>http://context/app/assets/images/mon_image.png</code></p>
<h2 id="la-solution">La solution</h2>
<p>La solution est simple, il suffit d&rsquo;utiliser systématiquement la directive <code>ng-src</code>.</p>
<p>Les opérateurs ne savent pas les traiter et les laissent tels quels, ce qui permet à <strong>AngularJS</strong> de faire son travail correctement et d&rsquo;afficher les images.</p>
<p>Un second avantage est que dans <strong>Angular 2</strong>, il est fortement recommandé d&rsquo;utiliser cette directive, ce qui permet, d&rsquo;ors et déjà, de prendre de bonnes habitudes.</p>
<p>Le projet d&rsquo;exemple se trouve sur <a href="https://github.com/richard-fagot/rfd-disparition">https://github.com/richard-fagot/rfd-disparition</a> et on peut le tester en live sur <a href="http://richard-fagot.github.io/rfd-disparition/">http://richard-fagot.github.io/rfd-disparition/</a>.</p>
<h2 id="corollaire">Corollaire</h2>
<p>Ce problème de parasitage de l&rsquo;opérateur complexifie encore plus la phase de test des applications web mobiles : non seulement il faut tester l&rsquo;application sur différents modèles de téléphones et tablettes, d&rsquo;OS et de navigateurs mais, en plus, il faut tester sur différents opérateurs et réseaux (3G, 4G, etc.).</p>
<p>Dans notre cas, les images étaient absentes pour un opérateur bien connu en 3G seulement (en 4G ça marchait correctement) et pour un opérateur virtuel reposant sur le réseau d&rsquo;un autre opérateur physique que le premier et en 3G également.</p>


        
          <div class="blog-tags">
            
              <a href="https://richard-fagot.github.io//tags/angular/">Angular</a>&nbsp;
            
              <a href="https://richard-fagot.github.io//tags/op%C3%A9rateur-mobile/">Opérateur mobile</a>&nbsp;
            
              <a href="https://richard-fagot.github.io//tags/images/">Images</a>&nbsp;
            
          </div>
        

        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://richard-fagot.github.io/post/le-jeu-de-la-vie-en-drools/" data-toggle="tooltip" data-placement="top" title="Drools, Le jeu de la vie">&larr; Post précédent</a>
            </li>
          
          
            <li class="next">
              <a href="https://richard-fagot.github.io/post/retour-code-retreat-2016/" data-toggle="tooltip" data-placement="top" title="Retours sur le Code Retreat 2016">Post suivant &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/richard-fagot" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/@richardfagot" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/richardfagot" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://richard-fagot.github.io/">Richard Fagot</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2018
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://richard-fagot.github.io/">Richard Fagot</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          Carbure avec <a href="https://gohugo.io">Hugo v0.69.2</a>&nbsp;&bull;&nbsp; Avec le Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapté de <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://richard-fagot.github.io/js/main.js"></script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://richard-fagot.github.io/js/load-photoswipe.js"></script>









    
  </body>
</html>

